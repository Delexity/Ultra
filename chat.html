<!DOCTYPE html>
<html>
  <body>
      <script type="module">
        import { getDatabase, ref, set, onValue } from "https://www.gstatic.com/firebasejs/9.1.2/firebase-database.js";
        import { initializeApp } from 'https://www.gstatic.com/firebasejs/9.1.2/firebase-app.js';
var config = {
  apiKey: "AIzaSyB_hzolxZ5TRuPOPnjZ5dIUY_lsNfTOQi0",
  authDomain: "cursor-d3be2.firebaseapp.com",
  databaseURL: "https://cursor-d3be2-default-rtdb.firebaseio.com",
  projectId: "cursor-d3be2",
  storageBucket: "cursor-d3be2.appspot.com",
  messagingSenderId: "720790815052",
  appId: "1:720790815052:web:9846b1bf702bbca6c50fe9"
};
const app = initializeApp(config);

function writeData(chat, name) {
  const db = getDatabase();
  set(ref(db, 'users/' + chat), {
    username: name
  });
}
function getUrlParams() {
  const urlParams = new URLSearchParams(window.location.search);
  const text = urlParams.get('text');
  const username = urlParams.get('username');
  return { text, username };
}

const { text, username } = getUrlParams();

writeData(username, text);

  const db = getDatabase();
const usersRef = ref(db, 'users');

onValue(usersRef, (snapshot) => {
  snapshot.forEach((childSnapshot) => {
    const childKey = childSnapshot.key; // gets the folder name
    const childData = childSnapshot.val(); // gets the data in the folder
    const textValue = childData.text; // gets the value of the "text" property

    console.log(`FOLDERNAME: ${childKey}, TEXT: ${textValue}`);
  });
});
      </script>
<form action="./" method="get">
    <input name="text">
    <input name="username">
    <button type="submit">Submit</button>
</form>
  </body>
</html>
